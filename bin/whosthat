#!/usr/bin/perl
use strict;
use warnings;
use WhosThat;
use YAML::Tiny;
use Data::Dumper;

my @args = @ARGV;
print Dumper( @args );

print "Data is in $DATA\n";

# Check all of the people we know
my $whodir = $DATA . '/who';
opendir(DIR, $whodir) or die "Could not open $whodir\n";

while (my $whofile = readdir(DIR)) {
    next if $whofile =~ m/^\./;
    next if $whofile =~ m/template/;
    print "$whofile\n";

    # slurp
    my $who = YAML::Tiny->read( $DATA . '/who/' . $whofile );

    # Is this who we're looking for?
    if (    # Name
        $who->[0]->{name} =~ /@args/i
        ||    #Email
        $who->[0]->{email} =~ /@args/i
      )
    {
        print Dumper($who);
    }
}

closedir(DIR);


